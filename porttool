#!/opt/local/bin/bash
if [ "$1" == "stamp" ]; then
	stamp=$(date "+%Y%m%d%H%M")
	name=$(sed "s/\.[^.]*$/-$stamp&/" <<< $2)
	echo "Timestamping $2, are you sure? (y/n)"
	read confirm
	if [ "$confirm" == "y" ]; then
		mv "$2" "$name"
		echo "File now timestamped; moved to $name."
	fi
elif [ "$1" == "up" ]; then
	echo "Uploading to https://ports.sgi.sh/$2/$3/$4, are you sure? (y/n)"
	read confirm
	if [ "$confirm" == "y" ]; then
		aws s3 cp $4 s3://sgi-dev-public/$2/$3/
	else 
		echo "Cancelled."
	fi
elif [ "$1" == "rm" ]; then
	echo "Removing https://ports.sgi.sh/$2/$3/$4, are you sure? (y/n)"
	read confirm
	if [ "$confirm" == "y" ]; then
		aws s3 rm s3://sgi-dev-public/$2/$3/$4
	else
		echo "Cancelled."
	fi
else
	echo -e "Usage:\nporttool [up/rm] [category] [name] [package]\nEx.: porttool up editors emacs emacs-26.1-201901171502.tardist\n\nporttool [stamp] [name]\nEx.: porttool stamp emacs-26.1.tardist"
fi
